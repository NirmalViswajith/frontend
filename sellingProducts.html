<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <div>
      <form id="productForm">
        <label for="productName">Product Name:</label>
        <input type="text" name="productName" id="productName" />
        <label for="sellingPrice">Selling Price:</label>
        <input type="number" name="sellingPrice" id="sellingPrice" />
        <label for="items">Choose a category: </label>
        <select name="items" id="items">
          <option value="ElectronicItems">Electronic Items</option>
          <option value="FoodItems">Food Items</option>
          <option value="SkincareItems">Skincare Items</option>
        </select>
        <button type="button" id="button" onclick="addproducts()">
          Add Products
        </button>
      </form>
    </div>
    <hr />
    <div>
      <h3>Electronic Items</h3>
      <ul id="electronicItems"></ul>
      <h3>Food Items</h3>
      <ul id="foodItems"></ul>
      <h3>Skincare Items</h3>
      <ul id="skincareItems"></ul>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
      async function addproducts() {
        const productName = document.getElementById("productName").value;
        const sellingPrice = document.getElementById("sellingPrice").value;
        const category = document.getElementById("items").value;
        const products = {
          productName,
          sellingPrice,
          category,
        };
        try {
          await axios.post(
            "https://crudcrud.com/api/3ef1ec6f4c8346e4a4d613482634a58c/productList",
            products
          );
          if (products.category == "ElectronicItems") {
            addlistElectronic(products);
          } else if (products.category == "FoodItems") {
            addlistFood(products);
          } else {
            addlistSkin(products);
          }
          document.getElementById("productName").value = "";
          document.getElementById("sellingPrice").value = "";
        } catch (error) {
          console.log(error);
        }
      }
      function addlistElectronic(products) {
        const parentList = document.getElementById("electronicItems");
        const listItems = document.createElement("li");
        listItems.innerText = `${products.productName} - ${products.sellingPrice} - ${products.category}`;
        const delButton = document.createElement("button");
        delButton.innerText = "Delete";
        delButton.addEventListener("click", deleteProduct(products._id, listItems));
        listItems.appendChild(delButton);
        parentList.appendChild(listItems);
      }

      function addlistFood(products) {
        const parentList = document.getElementById("foodItems");
        const listItems = document.createElement("li");
        listItems.innerText = `${products.productName} - ${products.sellingPrice} - ${products.category}`;
        const delButton = document.createElement("button");
        delButton.innerText = "Delete";
        delButton.addEventListener("click", deleteProduct(products._id, listItems));
        listItems.appendChild(delButton);
        parentList.appendChild(listItems);
      }

      function addlistSkin(products) {
        const parentList = document.getElementById("skincareItems");
        const listItems = document.createElement("li");
        listItems.innerText = `${products.productName} - ${products.sellingPrice} - ${products.category}`;
        const delButton = document.createElement("button");
        delButton.innerText = "Delete";
        delButton.addEventListener("click", deleteProduct(products._id, listItems));
        listItems.appendChild(delButton);
        parentList.appendChild(listItems);
      }

      async function fetchItems() {
        try {
          const response = await axios.get(
            "https://crudcrud.com/api/3ef1ec6f4c8346e4a4d613482634a58c/productList"
          );
          const products = response.data;
          products.forEach((product) => {
            if (product.category === "ElectronicItems") {
              addlistElectronic(product);
            } else if (product.category === "FoodItems") {
              addlistFood(product);
            } else {
              addlistSkin(product);
            }
          });
        } catch (error) {
          console.log(error);
        }
      }

      function deleteProduct(productId, listItem) {
        return async function () {
          try {
            await axios.delete(
              `https://crudcrud.com/api/3ef1ec6f4c8346e4a4d613482634a58c/productList/${productId}`
            );
            listItem.remove();
          } catch (error) {
            console.log(error);
          }
        };
      }
      window.addEventListener("DOMContentLoaded", async () => {
        await fetchItems();
      });
    </script>
  </body>
</html>
